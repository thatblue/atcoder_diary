# 経験則

**疲れていたり体調が悪かったり、本調子じゃないときはロクな結果にならず無駄に凹むのでRatedで参加しない**

概ね方針が出ているのにスッと解けない場合は読む。

- D問題でも全探索が必要(可能)なケースはある。問題文のデータ量制約はきちんと読み込むこと。Rubyの場合、2secの制約で回せるループの上限は概ね10^8と言われている。
    - データ数が10個未満だと組み合わせ全探索出来るかも
        - 10～20個ならbit全探索の可能性を検討する
    - 1000個くらいならN*Nの二次元DPができる
    - 10^5くらいだとN*Nの二重ループが間に合わないので、事前のソートとか二分探索とか一次元DPなどなど工夫する必要がある
        - 定数回のループであれば十分可能
- 値を複数受け取ったとき、ソートが出来ないか(順番に意味があるのか)を考える。ソートが出来るなら二分探索が使えるようになったりする。(ABC321-D)
- 配列のインデックスの取り回しに気を付ける。問題文は大体1-indexになっているが、ダミーデータを詰めてインデックスを動かすか読み替えをするかでうまくやる。
- 定数倍が重い問題の場合、ハッシュのキーを数字以外にするとTLEを起こすことがある。文字をインデックスに置き換えるなど、何かしらの工夫をする。
- DPするときは初期値に注意。負数が入りうるときに0を詰めたり、最小値を取りたいときに適当な値が小さすぎたりしないように気を付ける。
- DFSとBFSは結構な確率で互換性がある。DFSで解いてみてTLEが10個～半分弱くらい出るようであればBFSでの書き換えを検討する、逆もしかり。
    - 最長経路が欲しいときはDFSじゃないと無理。
- 1と0だったり、#と.だったり、boolで表現出来るときはビット演算を使うと早いケースがある。
    - Rubyでは0はtrueになるので、条件式に突っ込むときは気を付ける
- 見た目がグラフだとDFS/BFSをやりたくなりがちだが、D問題以上ではDPやUnionFindの可能性も検討する。
- DPだからと言って素朴に二次元配列を作るとランタイムエラーを起こすことがある。ハッシュの利用も検討する。
- 逆に定数倍が重い問題の場合、常識的な範囲であれば変にハッシュにすると微妙に重たくなってTLEが取れないことがある。(ABC315-D)
- 問題文で「剰余を出す」って言われるようなケースでべき乗したいときは `Integer#pow` を使って第二引数に指定された素数を必ず指定すること。
- `Math#sqrt` や `Math#log2` みたいなfloatが返ってくる処理は出力直前にやる。大小比較だけなら処理前の値でも可能。
- どうしても小数点以下が出る値で大小比較をしないといけない場合、計算前の整数値にto_rしておく
- 約数列が欲しいときは `Math.sqrt(n)` まで探せば十分。sqrtの端数は切り捨てでOK。
    - ぴったり平方根のときの過不足に注意、順番が大事なときはsortを忘れずに
- 400点未満の問題なら必要な知識はほぼ必ず持っている。
- 500点未満の問題なら解法は持っている可能性が高いので、何が分かればよいのかを見抜けるかどうか。
- 500点の問題もDPか二分探索が解法と読めるならワンチャンある。
- 詰まってて何となく類題が浮かんだらその時のブログとか解説とか読むとヒントが見つかるかもしれない。
- 複数の操作が必要な場合、AやってBでTLE起こすならBやってAも試してみる。
- トポロジカルソートから一部の内容を抜粋する必要がある場合、対象となるノードを何らかの方法で絞り込んでから実行する方法もあるけど、間に合わないことがままあるのでDFSして帰りがけにノードを拾っていく方がよいケースがある。(ABC315-E)
- Rubyの場合、パフォーマンス的に10倍くらい不利なので計算量がカツカツな問題で微妙にTLE起こした場合は「この難易度でこの解法必要かなぁ」と思わず考えてみるのは必要
    - 具体的に言うとC問題で想定解法が素朴なDFSでもメモ化再帰が必要なことがあった(ABC317-C)
- 二分探索で先の値を使うと面倒になりそうな場合、検索対象の配列をreverseして手前の値を使うことも検討する
    - 累積和で中途半端な値を処理するときにどっちかが楽とかあるかも(ABC305-D)
- 「値が0～9のいずれか(もしくは10進数の文字列をこねくり回す問題)」や「英大文字(小文字)のみ」という制約がある場合、その制約を使うとループのサイズが絞り込めることが多い。(ABC320-C、ABC321-Cなど)
- 「ソートした上で配列のインデックスを保持したい」だけの要求であればPriorityQueueを持ち出すまでもなく、配列の中身を工夫するだけでよかったりする(ABC331-E)
